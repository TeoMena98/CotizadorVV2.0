<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <title>Cotizador Viaja VIP</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>

<body class="bg-dark text-white">

  <div class="container py-4">
    <h1 class="text-center">üõ´ Cotizador Viaja Vip</h1>

    <form id="formBusqueda" class="row g-3 mt-4">

      <!-- ORIGEN -->
      <div class="col-md-6">
        <label class="form-label">Origen</label>
        <select class="form-select" id="origen">
          <option value="BOG">Bogot√° (BOG)</option>
          <option value="CLO">Cali (CLO)</option>
          <option value="MDE" selected>Medell√≠n (MDE)</option>
          <option value="CTG">Cartagena (CTG)</option>
          <option value="BAQ">Barranquilla (BAQ)</option>
          <option value="BGA">Bucaramanga (BGA)</option>
          <option value="LET">Leticia (LET)</option>
          <option value="AXM">Armenia (AXM)</option>
          <option value="PEI">Pereira (PEI)</option>
          <option value="PSO">Pasto (PSO)</option>
          <option value="PPN">Popay√°n (PPN)</option>
          <option value="SMR">Santa Marta (SMR)</option>
          <option value="MTR">Monter√≠a (MTR)</option>
          <option value="RCH">Riohacha (RCH)</option>
          <option value="MVP">Mit√∫ (MVP)</option>
          <option value="IBE">Ibagu√© (IBE)</option>
          <option value="NVA">Neiva (NVA)</option>
        </select>
      </div>

      <!-- DESTINO -->
      <div class="col-md-6">
        <label class="form-label">Destino</label>
        <select class="form-select" id="destino">
          <option value="PUJ">Punta Cana (PUJ)</option>
          <option value="CUN">Canc√∫n (CUN)</option>
        </select>
      </div>

      <!-- FECHA IDA -->
      <div class="col-md-6">
        <label class="form-label">Fecha Ida</label>
        <input type="date" class="form-control" id="fechaIda" required>
      </div>

      <!-- FECHA REGRESO -->
      <div class="col-md-6">
        <label class="form-label">Fecha Regreso</label>
        <input type="date" class="form-control" id="fechaRegreso" required>
      </div>

      <!-- PASAJEROS -->
      <div class="col-md-4">
        <label class="form-label">Adultos</label>
        <input type="number" id="adultos" class="form-control" min="1" value="1">
      </div>
      <div class="col-md-4">
        <label class="form-label">Ni√±os (2-17)</label>
        <input type="number" id="ninos" class="form-control" min="0" value="0">
        <div id="edadesNinos" class="mt-2"></div>
      </div>
      <div class="col-md-4">
        <label class="form-label">Infantes (0-1)</label>
        <input type="number" id="infantes" class="form-control" min="0" value="0">
        <div id="edadesInfantes" class="mt-2"></div>
      </div>

      <!-- BOTONES -->
      <div class="col-6">
        <button type="submit" class="btn btn-primary w-100">Buscar Vuelos</button>
      </div>
      <div class="col-6">
        <button type="button" class="btn btn-success w-100" data-bs-toggle="modal" data-bs-target="#vueloManualModal">
          ‚ûï Agregar vuelo manual
        </button>
      </div>

      <div class="col-12 mt-3">
        <button id="btnCotizacion" type="button" class="btn btn-warning w-100 d-none">
          üìÑ Generar Cotizaci√≥n
        </button>
      </div>
    </form>

    <!-- Contenedor de Resultados -->
    <div id="resultados" class="mt-4"></div>
    <div id="loading" class="text-center mt-4 d-none">
      <div class="spinner-border text-warning" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-2">Cargando resultados...</p>
    </div>

  </div>

  <!-- MODAL VUELO MANUAL -->
  <div class="modal fade" id="vueloManualModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content bg-dark text-white">
        <div class="modal-header">
          <h5 class="modal-title">‚úç Ingresar Vuelo Manual</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="formVueloManual" class="needs-validation" novalidate>

            <!-- Vuelo de IDA -->
            <h5 class="text-info">‚úà Vuelo de IDA</h5>
            <div class="row g-3 mt-2">
              <div class="col-md-6">
                <label class="form-label">Fecha Ida</label>
                <input type="date" id="fechaIda" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Aerol√≠nea</label>
                <input type="text" id="aerolineaIda" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Hora Salida</label>
                <input type="time" id="horaSalidaIda" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Hora Llegada</label>
                <input type="time" id="horaLlegadaIda" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Duraci√≥n</label>
                <input type="text" id="duracionIda" class="form-control" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Tipo</label>
                <select id="tipoIda" class="form-select">
                  <option value="directo">Directo</option>
                  <option value="escala">Con escalas</option>
                </select>
              </div>
            </div>
            <div id="escalasIda" class="mt-3"></div>

            <!-- Vuelo de REGRESO -->
            <h5 class="text-info mt-4">‚úà Vuelo de REGRESO</h5>
            <div class="row g-3 mt-2">
              <div class="col-md-6">
                <label class="form-label">Fecha Regreso</label>
                <input type="date" id="fechaRegreso" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Aerol√≠nea</label>
                <input type="text" id="aerolineaRegreso" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Hora Salida</label>
                <input type="time" id="horaSalidaRegreso" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Hora Llegada</label>
                <input type="time" id="horaLlegadaRegreso" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label class="form-label">Duraci√≥n</label>
                <input type="text" id="duracionRegreso" class="form-control" readonly>
              </div>
              <div class="col-md-6">
                <label class="form-label">Tipo</label>
                <select id="tipoRegreso" class="form-select">
                  <option value="directo">Directo</option>
                  <option value="escala">Con escalas</option>
                </select>
              </div>
            </div>
            <div id="escalasRegreso" class="mt-3"></div>

            <!-- Precio -->
            <h5 class="text-info mt-4">üí∞ Precio</h5>
            <div class="col-12">
              <label class="form-label">Precio (COP)</label>
              <input type="text" id="precio" class="form-control" placeholder="COP 0" required>
            </div>

            <!-- Bot√≥n -->
            <div class="mt-4">
              <button type="submit" class="btn btn-success w-100">üíæ Guardar Vuelo</button>
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Formatear precio en COP
    document.getElementById("precio").addEventListener("input", function (e) {
      let valor = e.target.value.replace(/[^0-9]/g, "");
      if (valor) {
        e.target.value = "COP " + Number(valor).toLocaleString("es-CO");
      } else {
        e.target.value = "";
      }
    });

    // Mostrar escalas din√°micas
    function manejarEscalas(tipoId, contenedorId) {
      let tipo = document.getElementById(tipoId);
      let contenedor = document.getElementById(contenedorId);

      tipo.addEventListener("change", () => {
        contenedor.innerHTML = "";
        if (tipo.value === "escala") {
          let inputNum = document.createElement("input");
          inputNum.type = "number";
          inputNum.min = 1;
          inputNum.max = 5;
          inputNum.value = 1;
          inputNum.className = "form-control mt-2";
          inputNum.addEventListener("input", () => crearCamposEscalas(contenedor, inputNum.value));
          contenedor.appendChild(document.createTextNode("N√∫mero de escalas:"));
          contenedor.appendChild(inputNum);
          crearCamposEscalas(contenedor, 1);
        }
      });
    }

    function crearCamposEscalas(contenedor, n) {
      // Elimina campos viejos
      let existentes = contenedor.querySelectorAll(".escala");
      existentes.forEach(e => e.remove());

      for (let i = 1; i <= n; i++) {
        let div = document.createElement("div");
        div.className = "escala mt-2";
        div.innerHTML = `<label>Escala ${i} (h:m)</label>
      <div class="d-flex gap-2">
        <input type="number" min="0" max="12" class="form-control" placeholder="Horas">
        <input type="number" min="0" max="59" step="5" class="form-control" placeholder="Minutos">
      </div>`;
        contenedor.appendChild(div);
      }
    }

    // Inicializar escalas din√°micas
    manejarEscalas("tipoIda", "escalasIda");
    manejarEscalas("tipoRegreso", "escalasRegreso");
  </script>

  <script>
    function mostrarLoading() {
      document.getElementById("loading").classList.remove("d-none");
      document.getElementById("resultados").innerHTML = "";
    }

    function ocultarLoading() {
      document.getElementById("loading").classList.add("d-none");
    }

    function mostrarResultados(vuelos) {
      ocultarLoading();
      const contenedor = document.getElementById("resultados");

      if (!vuelos) {
        contenedor.innerHTML = "<p>No se encontraron vuelos</p>";
        document.getElementById("btnCotizacion").classList.add("d-none");
        return;
      }

      let html = "";

      if (vuelos.ida) {
        html += `
      <div class="card bg-dark text-white p-3 mb-3">
        <h5>‚úàÔ∏è Ida</h5>
        <p><strong>Aerol√≠nea:</strong> ${vuelos.ida.aerolinea}</p>
        <p><strong>Salida:</strong> ${vuelos.ida.salida} - <strong>Llegada:</strong> ${vuelos.ida.llegada}</p>
        <p><strong>Duraci√≥n:</strong> ${vuelos.ida.duracion}</p>
        <p><strong>Tipo:</strong> ${vuelos.ida.tipo}</p>
      </div>`;
      }

      if (vuelos.regreso) {
        html += `
      <div class="card bg-dark text-white p-3 mb-3">
        <h5>üõ¨ Regreso</h5>
        <p><strong>Aerol√≠nea:</strong> ${vuelos.regreso.aerolinea}</p>
        <p><strong>Salida:</strong> ${vuelos.regreso.salida} - <strong>Llegada:</strong> ${vuelos.regreso.llegada}</p>
        <p><strong>Duraci√≥n:</strong> ${vuelos.regreso.duracion}</p>
        <p><strong>Tipo:</strong> ${vuelos.regreso.tipo}</p>
      </div>
      <div class="alert alert-success">
        <strong>üí∞ Precio total:</strong> ${vuelos.precio}
      </div>`;
      }

      contenedor.innerHTML = html;

      if (vuelos.ida || vuelos.regreso) {
        document.getElementById("btnCotizacion").classList.remove("d-none");
      } else {
        document.getElementById("btnCotizacion").classList.add("d-none");
      }
    }


  </script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="renderer.js"></script>
</body>

</html>